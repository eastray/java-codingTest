package problem17;

import java.util.HashMap;

public class GetFirstSundayOfEveryMonth {

	static int[] months = { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };
	static String[] dayOfTheWeek = { "sum", "mon", "tue", "wed", "thu", "fri", "sat" };

	private boolean isLeapYears(int n) {
		System.out.println("isLeapYears");

		if (n % 4 == 0) {
			if (n % 100 == 0)
				return false;

			if (n % 400 == 0)
				return true;

			return true;
		}

		return false;
	}

	private int getFirstSundayOfEveryMonth(String n, String m, HashMap<String, Integer> map) {
		System.out.println("getFirstSundayOfEveryMonth");

		if (!vaild(n) || !vaild(m))
			return -1;

		int start = Integer.parseInt(n.substring(0, 4));
		int end = Integer.parseInt(m.substring(0, 4));

		int result = 0;

		for (int i = start; i <= end; i++) {

			String temp = Integer.toString(i) + n.substring(4, n.length());

			result += getFirstSundayOfMonth(temp, m, getDayOfTheWeekByYear(temp, map));
			System.out.println(result);

		}

		return result;
	}

	private int getFirstSundayOfMonth(String n, String m, int dayOfWeek) {
		System.out.println("getFirstSundayOfMonth");

		int count = 0;
		int temp = 0;
		int diff = 0;

		if (isLeapYears(Integer.parseInt(n.substring(0, 4))))
			temp = 1;

		int month = Integer.parseInt(n.substring(4, 6));

		int end = Integer.parseInt(m.substring(4, 6));
		System.out.println("month: " + month);
		System.out.println("end: " + end);

		for (int i = month; i < end; i++) {

			temp += months[i - 1];
			System.out.println("temp: " + temp);

			if (diff > 6) {
				while (true) {

					diff -= 7;

					if (diff < 7)
						break;

				}
			}

			if (diff == 0)
				count++;

			diff = temp % 7 + dayOfWeek;
			
		}

		if (dayOfWeek == 0)
			count++;

		return count;

	}

	private int getDayOfTheWeekByYear(String n, HashMap<String, Integer> map) {
		System.out.println("getDayOfTheWeekByYear");

		if (!vaild(n))
			return -1;

		int standard = 1900;
		int days = 365;
		int diff = Integer.parseInt(n.substring(0, 4)) - standard;

		if (isLeapYears(Integer.parseInt(n.substring(0, 4))))
			days += 1;

		int temp = (days * diff) % 7;

		if (diff == 0)
			temp = days % 7;

		temp = map.get("19000101") + temp;

		return temp;

	}

	private boolean vaild(String str) {
		System.out.println("vaild");

		if (str.length() != 8) {
			System.out.println("getDayOfTheWeekByYear: not equals string length");
			return false;
		}

		return true;

	}

	public static void main(String[] args) {
		// TODO Auto-generated method stub

		HashMap<String, Integer> map = new HashMap<String, Integer>();
		map.put("19000101", 1);

		GetFirstSundayOfEveryMonth getSunday = new GetFirstSundayOfEveryMonth();

		System.out.println(getSunday.getFirstSundayOfEveryMonth("19010101", "20001231", map));
		// System.out.println(getSunday.getFirstSundayOfEveryMonth("19010101",
		// "19010303", map));

	}

}
